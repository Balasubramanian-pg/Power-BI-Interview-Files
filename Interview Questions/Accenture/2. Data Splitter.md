# Transforming Data with Power Query  

## **Problem Statement**  

**Given:** A table with names and comma-separated subjects:  

| Name  | Subjects               |  
|-------|------------------------|  
| John  | English, Physics, Maths |  
| Mike  | Physics, Maths         |  
| Alice | English                |  

**Task:** Transform this into a normalized structure where each subject appears on its own row with the name repeated:  

| Name  | Subject  |  
|-------|----------|  
| John  | English  |  
| John  | Physics  |  
| John  | Maths    |  
| Mike  | Physics  |  
| Mike  | Maths    |  
| Alice | English  |  

## **Step-by-Step Solution in Power Query**  

### **1. Split Subjects into Separate Columns**  
- Select the **Subjects** column.  
- Go to **Transform** > **Split Column** > **By Delimiter**.  
- Choose **Comma** as the delimiter.  
- Select **"Each occurrence"** to handle multiple subjects.  
- **Result**: Subjects split into `Subject.1`, `Subject.2`, etc.  

> [!TIP]  
> Use **"Each occurrence"** to ensure all subjects are captured, even if the number varies per row.  

### **2. Unpivot the Subject Columns**  
- Select all the new subject columns (`Subject.1`, `Subject.2`, etc.).  
- Right-click > **Unpivot Columns**.  
- **Result**: Creates three columns:  
  - **Name** (unchanged)  
  - **Attribute** (original column names, e.g., "Subject.1")  
  - **Value** (the actual subjects, e.g., "English")  

> [!IMPORTANT]  
> Unpivoting is crucial for normalizing the data into a single row per subject.  

### **3. Clean Up the Result**  
- Remove the **Attribute** column (it’s no longer needed).  
- Rename **Value** to **Subject**.  
- Trim whitespace (optional, in case subjects had spaces after commas).  

> [!NOTE]  
> Cleaning ensures the final table is tidy and ready for analysis.  

## **Power Query M Code (Advanced)**  

For reference, here’s the **M code** generated by these steps:  

```m
let
    Source = Table.FromRows(...),  // Original data
    SplitSubjects = Table.SplitColumn(Source, "Subjects", Splitter.SplitTextByDelimiter(",", QuoteStyle.Csv), {"Subject.1", "Subject.2", "Subject.3"}),
    Unpivoted = Table.Unpivot(SplitSubjects, {"Subject.1", "Subject.2", "Subject.3"}, "Attribute", "Subject"),
    RemovedColumn = Table.RemoveColumns(Unpivoted,{"Attribute"}),
    Trimmed = Table.TransformColumns(RemovedColumn, {{"Subject", Text.Trim}})
in
    Trimmed
```  
## **Alternative Method (Using `Text.Split`)**  

For more control, you could:  
1. Add a custom column with `Text.Split([Subjects], ",")`.  
2. Expand the resulting list into rows.  

**M Code for This Approach:**  

```m
let
    Source = Table.FromRows(...),
    SplitToList = Table.AddColumn(Source, "SubjectsList", each Text.Split([Subjects], ",")),
    Expanded = Table.ExpandListColumn(SplitToList, "SubjectsList"),
    Trimmed = Table.TransformColumns(Expanded, {{"SubjectsList", Text.Trim}}),
    Renamed = Table.RenameColumns(Trimmed, {{"SubjectsList", "Subject"}}),
    RemovedOriginal = Table.RemoveColumns(Renamed, {"Subjects"})
in
    RemovedOriginal
```  

> [!TIP]  
> This method is more flexible and works well when the number of subjects varies significantly.  

## **Key Concepts Tested**  

**Data Normalization**: Converting comma-separated values into a structured format.  
**Power Query Skills**: Splitting, unpivoting, and cleaning data.  
**Efficiency**: Choosing the simplest method for the task.  

## **Why This Matters in Interviews**  

- **Demonstrates your ability to reshape data** for analysis.  
- **Shows proficiency in Power Query**, a critical tool for ETL in Power BI.  
- **Highlights problem-solving** for common real-world data issues.  

## **Final Output**  

| Name  | Subject  |  
|-------|----------|  
| John  | English  |  
| John  | Physics  |  
| John  | Maths    |  
| Mike  | Physics  |  
| Mike  | Maths    |  
| Alice | English  |  

This document provides a clear, step-by-step guide to solving a common data transformation problem in Power BI using Power Query. It includes both UI-based and M code solutions, making it suitable for both beginners and advanced users.  

> [!TIP]  
> Practice this transformation with different datasets to reinforce your Power Query skills and prepare for similar interview questions.  
