## 21. What happens if two different data sources have different time zones in a DirectQuery model?

#### The Problem: Source System Authority
*   In a DirectQuery model, Power BI does not have a native time zone conversion engine. It sends queries to the underlying source systems and trusts the date/time data it gets back.
*   The source system's time zone is the "authority."
*   If you have one SQL Server in UTC and another in EST, a timestamp of `2023-10-27 10:00:00` from each source represents two completely different moments in time.

#### How It Manifests in a Report
*   **Incorrect Alignment:** When you put these timestamps on a shared visual axis, Power BI will treat `10:00:00` from both sources as the same point, leading to incorrect aggregation and misleading charts. Data that should be hours apart will be grouped together.
*   **Failed Relationships:** If you try to create a relationship between two DirectQuery tables from different time zones on a `DateTime` key, the joins will likely fail or produce incorrect results because the underlying values do not represent the same moments.

#### Best Practices for Resolution
*   **Standardize at the Source (Golden Rule):** The most robust solution is to perform time zone conversion in your ETL/ELT process before the data even reaches the source tables Power BI is querying. Store all `DateTime` data in a single, standardized time zone, preferably UTC.
*   **Standardize in a Database View:** If you cannot alter the source tables, create database views on top of them that convert the `DateTime` columns to a standard time zone (e.g., using `AT TIME ZONE` in T-SQL). Point your DirectQuery model to these views instead of the base tables.
*   **Power Query Conversion (with caution):**
    *   You can use Power Query's built-in time zone functions to perform conversions.
    *   **Warning:** This will almost certainly **break query folding**. The moment you apply a time zone transformation, the mashup engine has to pull the data from the source and perform the conversion in memory, defeating the purpose of DirectQuery. This should be avoided unless the dataset is small.

> **Key Takeaway:**
> * Power BI's DirectQuery mode is a query-passing mechanism, not a data transformation engine.
> * Time zone discrepancies must be resolved *before* the data gets to Power BI, either in the source itself or in a view layer. Relying on Power Query or DAX for time zone conversion in a DirectQuery model is an anti-pattern.
