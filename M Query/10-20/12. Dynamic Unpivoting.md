#### **Scenario 3: Dynamic Unpivoting**

You have data where new columns are added over time (e.g., a new column for each month). You want to unpivot these columns without having to manually edit the query every time the source changes.

**The Scenario:**
Your data has an `ID` column and then a separate column for each month: `Jan-23`, `Feb-23`, `Mar-23`, etc. Next month, `Apr-23` will be added. You want to unpivot these month columns dynamically.

**The Challenge:**
The standard `Unpivot Columns` UI hardcodes the names of the columns you are unpivoting. When a new month column is added to the source file, it will be ignored by your query.

**The M Query Solution:**
We get a list of all column names, remove the ones we want to keep fixed (the "ID" columns), and then use that dynamic list in the unpivot operation.

```m
let
    Source = Table.FromRecords({
        [StoreID="A", Region="North", #"Jan-23"=100, #"Feb-23"=110, #"Mar-23"=120],
        [StoreID="B", Region="South", #"Jan-23"=200, #"Feb-23"=210, #"Mar-23"=220]
    }),

    // Get the list of all column names from the source table
    AllColumnNames = Table.ColumnNames(Source),

    // Define the columns you DO NOT want to unpivot
    IDColumns = {"StoreID", "Region"},

    // Create a list of columns TO UNPIVOT by removing the ID columns from the full list
    ColumnsToUnpivot = List.RemoveItems(AllColumnNames, IDColumns),

    // Perform the unpivot using the dynamic list of column names
    #"Unpivoted Other Columns" = Table.Unpivot(Source, ColumnsToUnpivot, "Month", "Sales")

in
    #"Unpivoted Other Columns"
```
**Explanation:**
1.  `Table.ColumnNames(Source)` creates a list of all column headers (e.g., `{"StoreID", "Region", "Jan-23", ...}`).
2.  `List.RemoveItems()` subtracts the list of fixed columns from the list of all columns, resulting in a dynamic list of only the month columns.
3.  `Table.Unpivot` (the function behind the "Unpivot Other Columns" button) is used here. We explicitly tell it which columns to unpivot. Since that list is generated dynamically, the query will work even if new month columns are added later.
