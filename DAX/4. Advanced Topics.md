### **Advanced Logic**
12. **Running Total**  
    ```DAX 
    Running Total = 
    CALCULATE([Total Sales], FILTER(ALLSELECTED('Date'), 'Date'[Date] <= MAX('Date'[Date])) 
    ```  
    *Custom running aggregates without time intelligence.*

13. **Dynamic Segmentation (e.g., High/Medium/Low)**  
    ```DAX 
    Sales Tier = 
    SWITCH(TRUE(),
      [Total Sales] > 100000, "High",
      [Total Sales] > 50000, "Medium",
      "Low"
    ) 
    ```  
    *Uses `SWITCH` for conditional logic.*

14. **New vs. Returning Customers**  
    ```DAX 
    New Customers = 
    COUNTROWS(FILTER(Customers, CALCULATE(COUNT(Sales[SaleID]), ALLTIME()) = 1)) 
    ```  
    *Leverages `FILTER` and context transition.*

---

### **Optimization & Best Practices**
15. **Sales with Variables**  
    ```DAX 
    Sales with VAR = 
    VAR Total = [Total Sales]
    VAR Target = 100000
    RETURN IF(Total > Target, "Achieved", "Not Achieved") 
    ```  
    *Shows variable usage for readability/performance.*

16. **Handling Blanks**  
    ```DAX 
    Safe Sales = IF(ISBLANK([Total Sales]), 0, [Total Sales]) 
    ```  
    *Avoids unexpected blanks in visuals.*

17. **Row-Level Security Test**  
    ```DAX 
    Is Manager = IF(USERPRINCIPALNAME() = "manager@company.com", 1, 0) 
    ```  
    *Basic RLS pattern (may come up in interviews).*

---

### **Advanced Scenarios**
18. **Cohort Analysis (Retention)**  
    ```DAX 
    Cohort Retention = 
    CALCULATE([Total Sales], 
      FILTER(ALL('Date'), 'Date'[Month] = SELECTEDVALUE('Cohort'[Month])))
    ```  
    *Understands multi-table filtering.*

19. **Market Basket Analysis**  
    ```DAX 
    Bundled Products = 
    CALCULATE([Total Sales], 
      KEEPFILTERS(RELATEDTABLE(Products[ProductID] = "A" && Products[ProductID] = "B")) 
    ```  
    *Uses `KEEPFILTERS` for complex logic.*

20. **ABC Classification (Pareto)**  
    ```DAX 
    ABC Class = 
    VAR CumulativeSales = 
      SUMX(TOPN(100, VALUES(Product[ID]), [Total Sales], DESC), [Total Sales])
    RETURN
      IF(CumulativeSales <= 0.8, "A", IF(CumulativeSales <= 0.95, "B", "C")) 
    ```  
    *Applies the 80/20 rule in DAX.*

### **Key Concepts to Explain**
- **Context Transition**: How `CALCULATE` changes row context to filter context.
- **Iterators vs. Aggregators**: `SUMX` vs. `SUM`.
- **Relationship Handling**: `RELATED`, `USERELATIONSHIP`.
- **Performance**: Variables, avoid nested `CALCULATE`, minimize `FILTER`.

Practice these with sample datasets, and youâ€™ll ace 80% of DAX interview questions!
